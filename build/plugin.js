(()=>{var G=(f,a)=>()=>(a||f((a={exports:{}}).exports,a),a.exports);var X=G((k,w)=>{(function(f,a){typeof k=="object"&&typeof w<"u"?w.exports=a():typeof define=="function"&&define.amd?define(a):(f=typeof globalThis<"u"?globalThis:f||self).rexpinchplugin=a()})(k,function(){"use strict";function f(i){return(f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(i)}function a(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function D(i,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,n.key,n)}}function y(i,t,e){return t&&D(i.prototype,t),e&&D(i,e),i}function O(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),t&&P(i,t)}function v(i){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(i)}function P(i,t){return(P=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(i,t)}function x(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function j(i){var t=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var e,n=v(i);if(t){var r=v(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return function(s,o){if(o&&(typeof o=="object"||typeof o=="function"))return o;if(o!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return x(s)}(this,e)}}function C(i,t,e){return(C=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(n,r,s){var o=function(c,E){for(;!Object.prototype.hasOwnProperty.call(c,E)&&(c=v(c))!==null;);return c}(n,r);if(o){var h=Object.getOwnPropertyDescriptor(o,r);return h.get?h.get.call(s):h.value}})(i,t,e||i)}function _(i){if(f(i)!=="object"||i===null)return i;if(Array.isArray(i))i.length=0;else for(var t in i)delete i[t];return i}var L={setEventEmitter:function(i,t){return t===void 0&&(t=Phaser.Events.EventEmitter),this._privateEE=i===!0||i===void 0,this._eventEmitter=this._privateEE?new t:i,this},destroyEventEmitter:function(){return this._eventEmitter&&this._privateEE&&this._eventEmitter.shutdown(),this},getEventEmitter:function(){return this._eventEmitter},on:function(){return this._eventEmitter&&this._eventEmitter.on.apply(this._eventEmitter,arguments),this},once:function(){return this._eventEmitter&&this._eventEmitter.once.apply(this._eventEmitter,arguments),this},off:function(){return this._eventEmitter&&this._eventEmitter.off.apply(this._eventEmitter,arguments),this},emit:function(i){return this._eventEmitter&&i&&this._eventEmitter.emit.apply(this._eventEmitter,arguments),this},addListener:function(){return this._eventEmitter&&this._eventEmitter.addListener.apply(this._eventEmitter,arguments),this},removeListener:function(){return this._eventEmitter&&this._eventEmitter.removeListener.apply(this._eventEmitter,arguments),this},removeAllListeners:function(){return this._eventEmitter&&this._eventEmitter.removeAllListeners.apply(this._eventEmitter,arguments),this},listenerCount:function(){return this._eventEmitter?this._eventEmitter.listenerCount.apply(this._eventEmitter,arguments):0},listeners:function(){return this._eventEmitter?this._eventEmitter.listeners.apply(this._eventEmitter,arguments):[]},eventNames:function(){return this._eventEmitter?this._eventEmitter.eventNames.apply(this._eventEmitter,arguments):[]}},S=Phaser.Utils.Objects.GetValue,F=Phaser.Utils.Array.SpliceOne,A=Phaser.Math.Distance.Between,M=Phaser.Math.Angle.Between,N=function(){function i(t,e){a(this,i);var n=t.input.manager.pointersTotal-1;n<2&&t.input.addPointer(2-n),this.scene=t,this.setEventEmitter(S(e,"eventEmitter",void 0)),this._enable=void 0,this.pointers=[],this.movedState={},this.resetFromJSON(e),this.boot()}return y(i,[{key:"resetFromJSON",value:function(t){return this.setEnable(S(t,"enable",!0)),this.bounds=S(t,"bounds",void 0),this.tracerState=m,this.pointers.length=0,_(this.movedState),this}},{key:"boot",value:function(){this.scene.input.on("pointerdown",this.onPointerDown,this),this.scene.input.on("pointerup",this.onPointerUp,this),this.scene.input.on("pointermove",this.onPointerMove,this),this.scene.sys.events.once("shutdown",this.destroy,this)}},{key:"shutdown",value:function(){this.scene&&(this.destroyEventEmitter(),this.pointers.length=0,_(this.movedState),this.scene.input.off("pointerdown",this.onPointerDown,this),this.scene.input.off("pointerup",this.onPointerUp,this),this.scene.input.off("pointermove",this.onPointerMove,this),this.scene.sys.events.off("shutdown",this.destroy,this),this.scene=void 0)}},{key:"destroy",value:function(){this.shutdown()}},{key:"enable",get:function(){return this._enable},set:function(t){if(this._enable!==t)return t||this.dragCancel(),this._enable=t,this}},{key:"setEnable",value:function(t){return t===void 0&&(t=!0),this.enable=t,this}},{key:"toggleEnable",value:function(){return this.setEnable(!this.enable),this}},{key:"onPointerDown",value:function(t){if(this.enable&&this.pointers.length!==2&&(!this.bounds||this.bounds.contains(t.x,t.y))&&this.pointers.indexOf(t)===-1)switch(this.movedState[t.id]=!1,this.pointers.push(t),this.tracerState){case m:this.tracerState=d,this.onDrag1Start();break;case d:this.tracerState=u,this.onDrag2Start()}}},{key:"onPointerUp",value:function(t){if(this.enable&&(!this.bounds||this.bounds.contains(t.x,t.y))){var e=this.pointers.indexOf(t);if(e!==-1)switch(delete this.movedState[t.id],F(this.pointers,e),this.tracerState){case d:this.tracerState=m,this.onDrag1End();break;case u:this.tracerState=d,this.onDrag2End(),this.onDrag1Start()}}}},{key:"onPointerMove",value:function(t){if(this.enable&&t.isDown){var e=!this.bounds||this.bounds.contains(t.x,t.y),n=this.pointers.indexOf(t)!==-1;if(n||!e){if(n&&!e)this.onPointerUp(t);else if(this.movedState[t.id]||(this.movedState[t.id]=t.x!==t.downX||t.y!==t.downY),this.movedState[t.id])switch(this.tracerState){case d:this.onDrag1();break;case u:this.onDrag2()}}}}},{key:"dragCancel",value:function(){return this.tracerState===u&&this.onDrag2End(),this.pointers.length=0,_(this.movedState),this.tracerState=m,this}},{key:"onDrag1Start",value:function(){this.emit("drag1start",this)}},{key:"onDrag1End",value:function(){this.emit("drag1end",this)}},{key:"onDrag1",value:function(){this.emit("drag1",this)}},{key:"onDrag2Start",value:function(){this.emit("drag2start",this)}},{key:"onDrag2End",value:function(){this.emit("drag2end",this)}},{key:"onDrag2",value:function(){this.emit("drag2",this)}},{key:"distanceBetween",get:function(){if(this.tracerState!==u)return 0;var t=this.pointers[0],e=this.pointers[1];return A(t.x,t.y,e.x,e.y)}},{key:"angleBetween",get:function(){if(this.tracerState!==u)return 0;var t=this.pointers[0],e=this.pointers[1];return M(t.x,t.y,e.x,e.y)}},{key:"drag1Vector",get:function(){var t=this.pointers[0];if(t&&this.movedState[t.id]){var e=t.position,n=t.prevPosition;p.x=e.x-n.x,p.y=e.y-n.y}else p.x=0,p.y=0;return p}},{key:"centerX",get:function(){if(this.tracerState!==u)return 0;var t=this.pointers[0].position,e=this.pointers[1].position;return(t.x+e.x)/2}},{key:"centerY",get:function(){if(this.tracerState!==u)return 0;var t=this.pointers[0].position,e=this.pointers[1].position;return(t.y+e.y)/2}},{key:"prevCenterX",get:function(){if(this.tracerState!==u)return 0;var t=this.movedState[this.pointers[0].id]?this.pointers[0].prevPosition:this.pointers[0].position,e=this.movedState[this.pointers[1].id]?this.pointers[1].prevPosition:this.pointers[1].position;return(t.x+e.x)/2}},{key:"prevCenterY",get:function(){if(this.tracerState!==u)return 0;var t=this.movedState[this.pointers[0].id]?this.pointers[0].prevPosition:this.pointers[0].position,e=this.movedState[this.pointers[1].id]?this.pointers[1].prevPosition:this.pointers[1].position;return(t.y+e.y)/2}},{key:"movementCenterX",get:function(){return this.centerX-this.prevCenterX}},{key:"movementCenterY",get:function(){return this.centerY-this.prevCenterY}},{key:"setRecongizedStateObject",value:function(t){return this.recongizedState=t,this}},{key:"state",get:function(){return this.recongizedState.state},set:function(t){this.recongizedState.state=t}},{key:"cancel",value:function(){return this.state=I,this}}]),i}();Object.assign(N.prototype,L);function l(i,t,e){if(i&&typeof i!="number"){if(i.hasOwnProperty(t))return i[t];if(t.indexOf(".")===-1)return e;for(var n=t.split("."),r=i,s=e,o=0;o<n.length;o++){if(!r.hasOwnProperty(n[o])){s=e;break}s=r[n[o]],r=r[n[o]]}return s}return e}var p={},m=0,d=1,u=2,I="IDLE",R=function(){function i(t){a(this,i);var e=l(t,"states",void 0);e&&this.addStates(e);var n=l(t,"extend",void 0);if(n)for(var r in n)this.hasOwnProperty(r)&&this[r]!==void 0||(this[r]=n[r]);var s=l(t,"eventEmitter",void 0),o=l(t,"EventEmitterClass",void 0);this.setEventEmitter(s,o),this._stateLock=!1,this.resetFromJSON(t)}return y(i,[{key:"shutdown",value:function(){this.destroyEventEmitter()}},{key:"destroy",value:function(){this.shutdown()}},{key:"resetFromJSON",value:function(t){this.setEnable(l(t,"enable",!0)),this.start(l(t,"start",void 0));var e=l(t,"init",void 0);return e&&e.call(this),this}},{key:"toJSON",value:function(){return{curState:this.state,prevState:this.prevState,enable:this.enable,start:this._start}}},{key:"setEnable",value:function(t){return t===void 0&&(t=!0),this.enable=t,this}},{key:"toggleEnable",value:function(){return this.setEnable(!this.enable),this}},{key:"state",get:function(){return this._state},set:function(t){if(this.enable&&!this._stateLock&&this._state!==t){if(this._prevState=this._state,this._state=t,this._stateLock=!0,this.emit("statechange",this),this._prevState!=null){var e="exit_"+this._prevState,n=this[e];n&&n.call(this),this.emit(e,this)}if(this._stateLock=!1,this._state!=null){var r="enter_"+this._state,s=this[r];s&&s.call(this),this.emit(r,this)}}}},{key:"prevState",get:function(){return this._prevState}},{key:"start",value:function(t){return this._start=t,this._prevState=void 0,this._state=t,this}},{key:"goto",value:function(t){return t!=null&&(this.state=t),this}},{key:"next",value:function(){var t,e=this["next_"+this.state];return e&&(t=typeof e=="string"?e:e.call(this)),this.goto(t),this}},{key:"addState",value:function(t,e){typeof t!="string"&&(t=(e=t).name);var n=e.next;n&&(this["next_"+t]=n);var r=e.exit;r&&(this["exit_"+t]=r);var s=e.enter;return s&&(this["enter_"+t]=s),this}},{key:"addStates",value:function(t){if(Array.isArray(t))for(var e=0,n=t.length;e<n;e++)this.addState(t[e]);else for(var r in t)this.addState(r,t[r]);return this}},{key:"runMethod",value:function(t,e,n,r,s,o){var h=this[t+"_"+this.state];if(h){var c=arguments.length;switch(c){case 1:return h.call(this);case 2:return h.call(this,e);case 3:return h.call(this,e,n);case 4:return h.call(this,e,n,r);case 5:return h.call(this,e,n,r,s);case 6:return h.call(this,e,n,r,s,o)}for(var E=new Array(c-1),b=1;b<c;b++)E[b-1]=arguments[b];return h.apply(this,E)}}},{key:"update",value:function(t,e){this.runMethod("update",t,e)}},{key:"preupdate",value:function(t,e){this.runMethod("preupdate",t,e)}},{key:"postupdate",value:function(t,e){this.runMethod("postupdate",t,e)}}]),i}();Object.assign(R.prototype,L);var J=Phaser.Utils.Objects.GetValue,U=function(){O(t,N);var i=j(t);function t(e,n){var r;a(this,t);var s=x(r=i.call(this,e,n)),o={states:{IDLE:{enter:function(){s.prevDistance=void 0,s.scaleFactor=1}},BEGIN:{},RECOGNIZED:{enter:function(){s.emit("pinchstart",s)},exit:function(){s.emit("pinchend",s)}}},init:function(){this.state=B},eventEmitter:!1};return r.setRecongizedStateObject(new R(o)),r}return y(t,[{key:"resetFromJSON",value:function(e){return C(v(t.prototype),"resetFromJSON",this).call(this,e),this.setDragThreshold(J(e,"threshold",0)),this}},{key:"onDrag2Start",value:function(){this.scaleFactor=1,this.prevDistance=this.distanceBetween,this.state=T,this.dragThreshold===0&&(this.state=g)}},{key:"onDrag2End",value:function(){this.state=B}},{key:"onDrag2",value:function(){switch(this.state){case T:if(this.pointers[0].getDistance()>=this.dragThreshold&&this.pointers[1].getDistance()>=this.dragThreshold){var e=this.distanceBetween;this.scaleFactor=e/this.prevDistance,this.prevDistance=e,this.state=g}break;case g:e=this.distanceBetween,this.scaleFactor=e/this.prevDistance,this.emit("pinch",this),this.prevDistance=e}}},{key:"isPinched",get:function(){return this.state===g}},{key:"setDragThreshold",value:function(e){return this.dragThreshold=e,this}}]),t}(),B="IDLE",T="BEGIN",g="RECOGNIZED";return function(){O(t,Phaser.Plugins.BasePlugin);var i=j(t);function t(e){return a(this,t),i.call(this,e)}return y(t,[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this)}},{key:"add",value:function(e,n){return new U(e,n)}}]),t}()})});X();})();
//# sourceMappingURL=plugin.js.map
